<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grade 4 ‚Äì Unit 2 | Embedded Systems & Microcontrollers</title>
  <style>
    :root{
      --bg:#fff7e6;
      --bg2:#eaf7ff;
      --card:#ffffff;
      --card2:#f2fbff;
      --text:#1b2430;
      --muted:#42556b;
      --accent:#16a37c;
      --accent2:#1f7ad9;
      --warn:#f4a63a;
      --danger:#e35353;
      --border:rgba(27,36,48,.14);
      --shadow: 0 18px 36px rgba(27,36,48,.10);
      --radius:18px;
      --font-display:"Comic Sans MS", "Chalkboard SE", "Comic Neue", cursive;
      --font-body:"Comic Sans MS", "Chalkboard SE", "Comic Neue", "Trebuchet MS", sans-serif;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: var(--font-body);
      color:var(--text);
      font-weight:600;
      font-size:16px;
      background:
        radial-gradient(900px 500px at 10% 0%, rgba(31,122,217,.18), transparent 60%),
        radial-gradient(900px 500px at 90% 10%, rgba(22,163,124,.18), transparent 55%),
        radial-gradient(900px 600px at 60% 90%, rgba(244,166,58,.15), transparent 60%),
        linear-gradient(180deg, var(--bg2), var(--bg));
      min-height:100vh;
    }

    header{
      position:static;
      z-index:20;
      backdrop-filter: blur(10px);
      background: rgba(255,247,230,.88);
      border-bottom:1px solid var(--border);
    }

    .wrap{max-width:1100px;margin:0 auto;padding:clamp(10px, 1.6vw, 18px) clamp(14px, 3vw, 22px)}

    .topbar{
      display:flex;
      align-items:center;
      gap:14px;
      justify-content:space-between;
      flex-wrap:wrap;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
    }

    .logo{
      width:90px;height:90px;border-radius:16px;
      background: transparent;
      display:grid;place-items:center;
    }

    .logo img{
      width:100%;
      height:100%;
      object-fit:contain;
      border-radius:16px;
      box-shadow:none;
      border:none;
      background:transparent;
    }

    .brand h1{
      margin:0;
      font-size:clamp(15px, 1.8vw, 20px);
      line-height:1.2;
      letter-spacing:.2px;
      font-family: var(--font-display);
      font-weight:700;
    }
    .brand p{margin:0;color:var(--muted);font-size:12px;font-weight:600}

    .controls{
      display:flex;gap:10px;align-items:center;flex-wrap:wrap;
    }

    .search{
      display:flex;align-items:center;gap:8px;
      padding:8px 10px;
      border:1px solid var(--border);
      border-radius: 999px;
      background: rgba(255,255,255,.75);
      min-width:min(320px, 100%);
    }

    .search input{
      width:100%;
      border:none;outline:none;
      background:transparent;
      color:var(--text);
      font-size:14px;
    }

    .btn{
      border:1px solid var(--border);
      background: rgba(255,255,255,.75);
      color:var(--text);
      border-radius: 999px;
      padding:8px 10px;
      font-size:13px;
      font-weight:700;
      cursor:pointer;
      transition: transform .08s ease, background .2s ease;
    }
    .btn:hover{background: rgba(255,255,255,.95)}
    .btn:active{transform: translateY(1px)}

    .btn.toggle{
      font-weight:800;
    }
    main{padding:clamp(12px, 3vw, 20px) 0 40px}

    .grid{
      display:grid;
      grid-template-columns: minmax(220px, 280px) minmax(0, 1fr);
      gap:clamp(12px, 2.5vw, 18px);
      align-items:start;
    }

    @media (max-width: 920px){
      .grid{grid-template-columns: 1fr}
      nav{position:static !important}
    }

    nav{
      position:sticky;
      top:88px;
      align-self:start;
      border:1px solid var(--border);
      border-radius: var(--radius);
      background: rgba(255,255,255,.92);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .navHead{
      padding:14px 14px 10px;
      border-bottom:1px solid var(--border);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }

    .pill{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(16,24,40,.10);
      background: rgba(255,255,255,.9);
      color: var(--muted);
    }

    .navList{padding:10px}

    .navList button{
      width:100%;
      text-align:left;
      padding:10px 10px;
      border-radius: 12px;
      border:1px solid transparent;
      background: transparent;
      color: var(--text);
      cursor:pointer;
      font-size:14px;
      font-weight:700;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }

    .navList button:hover{background: rgba(31,157,138,.06)}
    .navList button.active{
      background: rgba(31,157,138,.12);
      border-color: rgba(31,157,138,.35);
    }

    .navList small{color:var(--muted)}

    .panel{
      border:1px solid var(--border);
      border-radius: var(--radius);
      background: rgba(255,255,255,.92);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .panelHeader{
      padding:clamp(16px, 2.5vw, 22px) clamp(16px, 2.5vw, 22px) 14px;
      border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(31,157,138,.08), transparent);
    }

    .panelHeader h2{margin:0;font-size:clamp(20px, 2.8vw, 26px);font-family: var(--font-display);font-weight:800}
    .panelHeader p{margin:8px 0 0;color:var(--muted);font-size:14px;line-height:1.5;font-weight:600}

    .content{padding:clamp(16px, 2.5vw, 22px)}

    .cards{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:12px;
    }

    @media (max-width: 700px){
      .cards{grid-template-columns: 1fr}
    }

    .card{
      border:1px solid var(--border);
      border-radius: 16px;
      background: var(--card);
      padding:clamp(12px, 2vw, 16px);
    }

    .card h3{margin:0 0 8px;font-size:16px;font-family: var(--font-display);font-weight:800}
    .card p{margin:0;color:var(--muted);font-size:14px;line-height:1.55;font-weight:600}

    .topic-illu{
      width:min(220px, 100%);
      height:auto;
      display:block;
      margin:0 0 10px;
    }
    .topic-illu .stroke,
    .example-illu .stroke,
    .mini-illu .stroke{stroke:var(--text);stroke-width:2;fill:none}
    .topic-illu .soft,
    .example-illu .soft,
    .mini-illu .soft{fill:rgba(31,157,138,.12)}
    .topic-illu .soft2,
    .example-illu .soft2,
    .mini-illu .soft2{fill:rgba(42,111,219,.12)}
    .topic-illu .accent,
    .example-illu .accent,
    .mini-illu .accent{fill:var(--accent)}
    .topic-illu .blue,
    .example-illu .blue,
    .mini-illu .blue{fill:var(--accent2)}
    .topic-illu .warn,
    .example-illu .warn,
    .mini-illu .warn{fill:var(--warn)}
    .topic-illu .paper,
    .example-illu .paper,
    .mini-illu .paper{fill:#ffffff;stroke:var(--border);stroke-width:2}

    .example-grid{
      margin-top:12px;
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap:12px;
    }
    .example-card{
      border:1px solid var(--border);
      border-radius: 14px;
      background: var(--card2);
      padding:12px;
      text-align:center;
      font-weight:700;
      font-size:13px;
      display:grid;
      gap:6px;
      justify-items:center;
    }
    .example-illu{
      width:100%;
      max-width:150px;
      height:auto;
      display:block;
    }

    .mini-examples{
      margin-top:10px;
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
      gap:10px;
    }
    .mini-card{
      border:1px solid var(--border);
      border-radius: 12px;
      background: var(--card2);
      padding:8px;
      text-align:center;
      font-weight:700;
      font-size:12px;
      display:grid;
      gap:6px;
      justify-items:center;
    }
    .mini-illu{
      width:100%;
      max-width:90px;
      height:auto;
      display:block;
    }

    .tagRow{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}

    .tag{
      font-size:12px;
      padding:6px 10px;
      border-radius: 999px;
      border:1px solid rgba(16,24,40,.12);
      background: rgba(255,255,255,.85);
      color: var(--text);
    }

    .tag.accent{border-color: rgba(31,157,138,.35); background: rgba(31,157,138,.10)}
    .tag.blue{border-color: rgba(42,111,219,.35); background: rgba(42,111,219,.10)}
    .tag.warn{border-color: rgba(226,166,58,.40); background: rgba(226,166,58,.12)}

    .accordion{margin-top:14px;display:grid;gap:10px}

    details{
      border:1px solid var(--border);
      border-radius: 16px;
      background: var(--card2);
      overflow:hidden;
    }

    summary{
      cursor:pointer;
      list-style:none;
      padding:12px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      font-weight:800;
      font-size:15px;
      font-family: var(--font-display);
    }

    summary::-webkit-details-marker{display:none}

    .detailBody{padding:0 14px 14px;color:var(--muted);font-size:14px;line-height:1.6;font-weight:600}

    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size:12px;
      padding:2px 6px;
      border-radius:8px;
      border:1px solid rgba(16,24,40,.12);
      background: rgba(255,255,255,.9);
      color: var(--text);
    }

    .flashWrap{margin-top:14px;display:grid;gap:12px}

    .flashCard{
      border:1px solid var(--border);
      border-radius: 18px;
      background: linear-gradient(135deg, rgba(31,122,217,.10), rgba(22,163,124,.10));
      padding:18px;
      min-height: 140px;
      cursor:pointer;
      user-select:none;
      perspective: 900px;
      position:relative;
      box-shadow: var(--shadow);
    }

    .flashInner{
      display:grid;
      gap:10px;
      transform-style: preserve-3d;
      transition: transform .45s ease;
      min-height: 120px;
      background: #fff;
      border-radius: 14px;
      padding:14px;
    }

    .flashCard.flipped .flashInner{
      transform: rotateY(180deg);
    }

    .flashFace{
      backface-visibility: hidden;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .flashBack{
      transform: rotateY(180deg);
      position:absolute;
      inset:16px;
    }

    .flashTop{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .flashTop .count{color:var(--muted);font-size:12px}

    .flashQ{font-size:18px;font-weight:800}
    .flashA{color:var(--muted);font-size:15px;line-height:1.55;font-weight:600}

    .flashActions{display:flex;gap:10px;flex-wrap:wrap}

    .quiz{
      margin-top:14px;
      border:1px solid var(--border);
      border-radius: 18px;
      background: var(--card);
      padding:16px;
    }

    .quiz h3{margin:0 0 10px;font-size:16px;font-family: var(--font-display);font-weight:800}

    .quiz-top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }

    .progress{
      height:10px;
      width:100%;
      border-radius:999px;
      background: rgba(16,24,40,.10);
      overflow:hidden;
    }
    .progress span{
      display:block;
      height:100%;
      width:0%;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      transition: width .3s ease;
    }

    .quiz-card{
      margin-top:12px;
      border:1px solid var(--border);
      border-radius: 16px;
      background: var(--card2);
      padding:14px;
      display:grid;
      gap:10px;
    }

    .quiz-card h4{
      margin:0;
      font-size:15px;
      font-weight:800;
    }

    .quiz-meta{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      color:var(--muted);
      font-size:13px;
      font-weight:700;
    }

    .q{
      border-top:1px solid rgba(255,255,255,.10);
      padding-top:12px;
      margin-top:12px;
    }

    .q:first-of-type{border-top:none;padding-top:0;margin-top:0}

    .q p{margin:0 0 10px;font-weight:600}

    .opts{display:grid;gap:8px}

    label.opt{
      display:flex;
      gap:10px;
      align-items:flex-start;
      padding:10px 10px;
      border-radius: 14px;
      border:1px solid rgba(16,24,40,.10);
      background: rgba(255,255,255,.9);
      cursor:pointer;
      font-weight:700;
    }

    label.opt:hover{background: rgba(31,157,138,.06)}

    .result{
      margin-top:12px;
      padding:12px;
      border-radius: 14px;
      border:1px solid rgba(16,24,40,.12);
      background: rgba(255,255,255,.85);
      color: var(--muted);
      display:none;
      font-weight:700;
    }

    .result.good{border-color: rgba(31,157,138,.35); background: rgba(31,157,138,.10); color: var(--text)}
    .result.bad{border-color: rgba(216,75,75,.35); background: rgba(216,75,75,.10); color: var(--text)}

    .revise{
      margin-top:10px;
      padding:10px;
      border-radius: 12px;
      border:1px dashed rgba(16,24,40,.18);
      background: rgba(255,255,255,.9);
      color: var(--muted);
      font-size:13px;
      font-weight:700;
    }

    @media (pointer: coarse){
      .navList button{padding:14px 12px;font-size:16px}
      .btn{padding:12px 14px;font-size:15px}
      .search{padding:12px 14px}
      .search input{font-size:15px}
      .flashCard{min-height:160px}
      .quiz-card{padding:16px}
    }

    body.large-text{
      font-size:18px;
    }
    body.large-text .brand h1{font-size:clamp(18px, 2.8vw, 26px)}
    body.large-text .brand p{font-size:14px}
    body.large-text .panelHeader h2{font-size:clamp(22px, 3.2vw, 30px)}
    body.large-text .panelHeader p{font-size:15px}
    body.large-text .navList button{font-size:16px}
    body.large-text .card h3{font-size:17px}
    body.large-text .card p{font-size:15px}
    body.large-text summary{font-size:16px}
    body.large-text .detailBody{font-size:15px}
    body.large-text .flashQ{font-size:18px}
    body.large-text .flashA{font-size:15px}
    body.large-text .quiz h3{font-size:17px}
    body.large-text .quiz-card h4{font-size:16px}
    body.large-text label.opt{font-size:15px}
    body.large-text .tiny{font-size:14px}
    body.large-text .footer{font-size:14px}

    .tiny{font-size:13px;color:var(--muted);font-weight:600}

    .footer{
      margin-top:14px;
      display:flex;
      justify-content:space-between;
      flex-wrap:wrap;
      gap:10px;
      color:var(--muted);
      font-size:13px;
      font-weight:600;
    }

    .hide{display:none !important}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="topbar">
        <div class="brand">
          <div class="logo"><img src="logo.png?v=2" alt="Grade 4 Creative Computing logo"></div>
          <div>
            <h1>Grade 4 ‚Äì Unit 2: Embedded Systems & Microcontrollers</h1>
            <p>Study notes ‚Ä¢ flashcards ‚Ä¢ mini quiz</p>
          </div>
        </div>
        <div class="controls">
          <div class="search" title="Search topics">
            <span aria-hidden="true">üîé</span>
            <input id="search" type="text" placeholder="Search: embedded system, input, NeoPixels‚Ä¶" />
          </div>
          <button class="btn toggle" id="textToggle" aria-pressed="false" title="Toggle large text">Aa Large Text</button>
          <button class="btn" id="printBtn" title="Print this page">üñ®Ô∏è Print</button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="wrap">
      <div class="grid">
        <nav aria-label="Topics">
          <div class="navHead">
            <strong>Topics</strong>
            <span class="pill" id="progressPill">0 / 7</span>
          </div>
          <div class="navList" id="navList">
            <button data-target="overview" class="active"><span>Overview</span><small>Start here</small></button>
            <button data-target="embedded"><span>Embedded Systems</span><small>Definition + examples</small></button>
            <button data-target="ipo"><span>Input ‚Üí Process ‚Üí Output</span><small>How systems work</small></button>
            <button data-target="micro"><span>Microcontrollers</span><small>The brain inside</small></button>
            <button data-target="programming"><span>Programming</span><small>Block + text</small></button>
            <button data-target="variables"><span>Variables</span><small>Data that changes</small></button>
            <button data-target="hardware"><span>NeoPixels & Pin Pads</span><small>Outputs + connections</small></button>
            <button data-target="practice"><span>Practice Quiz</span><small>Check yourself</small></button>
          </div>
        </nav>

        <section class="panel" id="panel">
          <div class="panelHeader">
            <h2 id="panelTitle">Overview</h2>
            <p id="panelDesc">Use the left menu. Read the notes, then try flashcards and the quiz.</p>
          </div>
          <div class="content">

            <!-- OVERVIEW -->
            <div class="page" id="overview">
              <div class="cards">
                <div class="card">
                  <svg class="topic-illu" viewBox="0 0 220 140" aria-hidden="true">
                    <rect x="12" y="18" width="120" height="90" rx="12" class="paper"></rect>
                    <rect x="28" y="36" width="88" height="10" rx="5" class="soft"></rect>
                    <rect x="28" y="56" width="72" height="8" rx="4" class="soft2"></rect>
                    <rect x="28" y="72" width="64" height="8" rx="4" class="soft2"></rect>
                    <circle cx="172" cy="48" r="18" class="warn"></circle>
                    <path d="M156 96h48" class="stroke"></path>
                    <path d="M162 86l10 10-10 10" class="stroke"></path>
                  </svg>
                  <h3>What you will learn</h3>
                  <p>‚Ä¢ What an embedded system is<br>‚Ä¢ Input ‚Üí Process ‚Üí Output<br>‚Ä¢ What a microcontroller is<br>‚Ä¢ Variables, NeoPixels, and pin pads</p>
                  <div class="tagRow">
                    <span class="tag accent">Easy notes</span>
                    <span class="tag blue">Examples</span>
                    <span class="tag warn">Practice</span>
                  </div>
                </div>
                <div class="card">
                  <h3>How to study</h3>
                  <p>1) Read one topic<br>2) Click flashcards (tap to flip)<br>3) Do the quiz<br>4) Use <span class="kbd">Print</span> if you want a paper copy</p>
                  <div class="tagRow">
                    <span class="tag">5‚Äì10 minutes</span>
                    <span class="tag">Grade 4</span>
                  </div>
                </div>
              </div>

              <div class="accordion">
                <details open>
                  <summary>Quick key words <span class="pill">cheat sheet</span></summary>
                  <div class="detailBody">
                    <b>Embedded system:</b> a small computer inside a machine.<br>
                    <b>Input:</b> button, sensor, touch, remote.<br>
                    <b>Process:</b> thinking/deciding inside the system.<br>
                    <b>Output:</b> light, sound, movement, screen, heat.<br>
                    <b>Microcontroller:</b> the ‚Äúbrain‚Äù (a small computer on one chip).<br>
                    <b>Variable:</b> a named box that stores data that can change.
                  </div>
                </details>
              </div>
            </div>

            <!-- EMBEDDED SYSTEMS -->
            <div class="page hide" id="embedded">
              <div class="cards">
                <div class="card">
                  <svg class="topic-illu" viewBox="0 0 220 140" aria-hidden="true">
                    <rect x="20" y="26" width="180" height="92" rx="14" class="soft2"></rect>
                    <rect x="52" y="46" width="60" height="50" rx="8" class="paper"></rect>
                    <rect x="122" y="56" width="58" height="36" rx="8" class="soft"></rect>
                    <path d="M70 56h24M70 68h24M70 80h24" class="stroke"></path>
                    <circle cx="150" cy="74" r="10" class="accent"></circle>
                  </svg>
                  <h3>Definition</h3>
                  <p>An <b>embedded system</b> is a small computer inside a bigger machine or device. It is made to do <b>specific jobs only</b>.</p>
                </div>
                <div class="card">
                  <h3>Important points</h3>
                  <p>‚Ä¢ You usually <b>cannot see</b> it<br>‚Ä¢ It is <b>built inside</b> devices<br>‚Ä¢ It follows <b>pre-programmed</b> instructions</p>
                </div>
              </div>

              <div class="accordion">
                <details open>
                  <summary>Examples</summary>
                  <div class="detailBody">
                    Washing machine ‚Ä¢ Air conditioner ‚Ä¢ Microwave ‚Ä¢ Car systems ‚Ä¢ Alarm systems ‚Ä¢ TV remote ‚Ä¢ Elevator
                    <div class="example-grid" aria-label="Embedded system examples">
                      <div class="example-card">
                        <svg class="example-illu" viewBox="0 0 180 120" aria-hidden="true">
                          <rect x="14" y="10" width="152" height="100" rx="14" class="paper"></rect>
                          <circle cx="58" cy="58" r="22" class="soft2"></circle>
                          <circle cx="58" cy="58" r="12" class="soft"></circle>
                          <circle cx="58" cy="58" r="3" class="accent"></circle>
                          <rect x="98" y="32" width="50" height="10" rx="5" class="soft"></rect>
                          <rect x="98" y="50" width="50" height="10" rx="5" class="soft2"></rect>
                          <rect x="98" y="68" width="32" height="10" rx="5" class="soft2"></rect>
                          <rect x="24" y="88" width="132" height="8" rx="4" class="soft2"></rect>
                        </svg>
                        Washing machine
                      </div>
                      <div class="example-card">
                        <svg class="example-illu" viewBox="0 0 180 120" aria-hidden="true">
                          <rect x="14" y="14" width="152" height="78" rx="12" class="paper"></rect>
                          <rect x="28" y="26" width="124" height="54" rx="8" class="soft2"></rect>
                          <rect x="34" y="32" width="112" height="42" rx="6" class="soft"></rect>
                          <rect x="46" y="96" width="88" height="8" rx="4" class="soft2"></rect>
                          <path d="M58 104l-8 8M122 104l8 8" class="stroke"></path>
                        </svg>
                        TV
                      </div>
                      <div class="example-card">
                        <svg class="example-illu" viewBox="0 0 180 120" aria-hidden="true">
                          <rect x="62" y="8" width="56" height="104" rx="16" class="paper"></rect>
                          <circle cx="90" cy="30" r="6" class="soft"></circle>
                          <rect x="74" y="44" width="32" height="26" rx="6" class="soft2"></rect>
                          <rect x="74" y="74" width="32" height="10" rx="5" class="soft"></rect>
                          <circle cx="78" cy="96" r="5" class="accent"></circle>
                          <circle cx="90" cy="96" r="5" class="blue"></circle>
                          <circle cx="102" cy="96" r="5" class="warn"></circle>
                        </svg>
                        TV remote
                      </div>
                      <div class="example-card">
                        <svg class="example-illu" viewBox="0 0 180 120" aria-hidden="true">
                          <rect x="20" y="52" width="140" height="36" rx="10" class="soft2"></rect>
                          <rect x="36" y="38" width="68" height="18" rx="6" class="paper"></rect>
                          <rect x="112" y="44" width="32" height="12" rx="6" class="paper"></rect>
                          <circle cx="44" cy="92" r="10" class="soft"></circle>
                          <circle cx="136" cy="92" r="10" class="soft"></circle>
                          <rect x="64" y="60" width="52" height="16" rx="8" class="soft"></rect>
                        </svg>
                        Car system
                      </div>
                      <div class="example-card">
                        <svg class="example-illu" viewBox="0 0 180 120" aria-hidden="true">
                          <rect x="24" y="18" width="132" height="88" rx="12" class="paper"></rect>
                          <rect x="36" y="32" width="108" height="50" rx="8" class="soft2"></rect>
                          <rect x="44" y="40" width="92" height="34" rx="6" class="soft"></rect>
                          <circle cx="62" cy="94" r="6" class="accent"></circle>
                          <circle cx="82" cy="94" r="6" class="blue"></circle>
                          <rect x="100" y="90" width="36" height="8" rx="4" class="soft2"></rect>
                        </svg>
                        Microwave
                      </div>
                      <div class="example-card">
                        <svg class="example-illu" viewBox="0 0 180 120" aria-hidden="true">
                          <rect x="30" y="18" width="120" height="84" rx="12" class="paper"></rect>
                          <rect x="42" y="26" width="96" height="20" rx="6" class="soft2"></rect>
                          <rect x="54" y="52" width="72" height="40" rx="8" class="soft"></rect>
                          <path d="M90 56v32M72 72h36" class="stroke"></path>
                        </svg>
                        Elevator
                      </div>
                      <div class="example-card">
                        <svg class="example-illu" viewBox="0 0 180 120" aria-hidden="true">
                          <rect x="26" y="26" width="128" height="70" rx="12" class="paper"></rect>
                          <circle cx="56" cy="60" r="16" class="soft2"></circle>
                          <path d="M50 60h12M56 54v12" class="stroke"></path>
                          <rect x="82" y="44" width="58" height="8" rx="4" class="soft2"></rect>
                          <rect x="82" y="60" width="46" height="8" rx="4" class="soft"></rect>
                          <rect x="82" y="76" width="36" height="8" rx="4" class="soft"></rect>
                        </svg>
                        Air conditioner
                      </div>
                    </div>
                  </div>
                </details>
                <details>
                  <summary>Why it is important</summary>
                  <div class="detailBody">
                    Embedded systems do specific tasks, are reliable, small in size, use less power, make machines smarter, and improve product quality.
                  </div>
                </details>
              </div>

              <div class="flashWrap">
                <h3 style="margin:0">Flashcards</h3>
                <div class="flashCard" id="flash1" role="button" aria-label="Flashcard. Tap to flip." tabindex="0">
                  <div class="flashInner">
                    <div class="flashFace">
                      <div class="flashTop"><span class="pill">Tap to flip</span><span class="count" id="flashCount">1 / 6</span></div>
                      <div class="flashQ" id="flashQ">What is an embedded system?</div>
                      <p class="tiny">Think of the answer before you flip.</p>
                    </div>
                    <div class="flashFace flashBack">
                      <div class="flashTop"><span class="pill">Answer</span><span class="count" id="flashCountBack">1 / 6</span></div>
                      <div class="flashA" id="flashA">A small computer inside a bigger machine or device that does specific jobs.</div>
                    </div>
                  </div>
                </div>
                <div class="flashActions">
                  <button class="btn" id="prevFlash" aria-label="Previous flashcard">
                    <svg width="28" height="28" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                      <circle cx="50" cy="50" r="45" fill="#00AEEF" stroke="#005D85" stroke-width="4"/>
                      <path d="M65 30 L35 50 L65 70" fill="none" stroke="white" stroke-width="8" stroke-linecap="round" stroke-linejoin="round"/>
                      <circle cx="35" cy="50" r="4" fill="white"/>
                    </svg>
                    Previous
                  </button>
                  <button class="btn" id="nextFlash" aria-label="Next flashcard">
                    Next
                    <svg width="28" height="28" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                      <circle cx="50" cy="50" r="45" fill="#00AEEF" stroke="#005D85" stroke-width="4"/>
                      <path d="M35 30 L65 50 L35 70" fill="none" stroke="white" stroke-width="8" stroke-linecap="round" stroke-linejoin="round"/>
                      <circle cx="65" cy="50" r="4" fill="white"/>
                    </svg>
                  </button>
                  <button class="btn" id="shuffleFlash" aria-label="Shuffle flashcards">
                    <svg width="28" height="28" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                      <circle cx="50" cy="50" r="45" fill="#F7941E" stroke="#B36200" stroke-width="4"/>
                      <path d="M25 35 L40 35 L60 65 L75 65" fill="none" stroke="white" stroke-width="6" stroke-linecap="round"/>
                      <path d="M25 65 L40 65 L60 35 L75 35" fill="none" stroke="white" stroke-width="6" stroke-linecap="round"/>
                      <polygon points="75,30 85,35 75,40" fill="white"/>
                      <polygon points="75,60 85,65 75,70" fill="white"/>
                    </svg>
                    Shuffle
                  </button>
                </div>
                <p class="tiny">Tip: say the answer out loud before flipping. Swipe left/right for next/previous.</p>
              </div>
            </div>

            <!-- IPO -->
            <div class="page hide" id="ipo">
              <div class="cards">
                <div class="card">
                  <svg class="topic-illu" viewBox="0 0 220 140" aria-hidden="true">
                    <rect x="14" y="50" width="52" height="36" rx="10" class="soft"></rect>
                    <rect x="84" y="40" width="52" height="56" rx="10" class="soft2"></rect>
                    <rect x="154" y="50" width="52" height="36" rx="10" class="warn"></rect>
                    <path d="M70 68h10M140 68h10" class="stroke"></path>
                    <path d="M74 62l6 6-6 6" class="stroke"></path>
                    <path d="M144 62l6 6-6 6" class="stroke"></path>
                  </svg>
                  <h3>Input</h3>
                  <p>Something that goes <b>into</b> the system.<br><br><b>Examples:</b> button, sensor, remote, touch</p>
                  <div class="mini-examples" aria-label="Input examples">
                    <div class="mini-card">
                      <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                        <rect x="18" y="18" width="84" height="54" rx="10" class="paper"></rect>
                        <circle cx="60" cy="45" r="14" class="soft2"></circle>
                        <circle cx="60" cy="45" r="6" class="accent"></circle>
                      </svg>
                      Button
                    </div>
                    <div class="mini-card">
                      <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                        <circle cx="60" cy="45" r="16" class="soft"></circle>
                        <path d="M80 45c8-6 8-14 0-20M40 45c-8-6-8-14 0-20" class="stroke"></path>
                      </svg>
                      Sensor
                    </div>
                    <div class="mini-card">
                      <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                        <rect x="44" y="12" width="32" height="66" rx="10" class="paper"></rect>
                        <circle cx="60" cy="28" r="4" class="soft"></circle>
                        <rect x="52" y="36" width="16" height="10" rx="4" class="soft2"></rect>
                        <circle cx="54" cy="56" r="4" class="accent"></circle>
                        <circle cx="66" cy="56" r="4" class="blue"></circle>
                      </svg>
                      Remote
                    </div>
                    <div class="mini-card">
                      <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                        <rect x="30" y="16" width="60" height="58" rx="12" class="paper"></rect>
                        <path d="M60 30v28M54 58h12" class="stroke"></path>
                        <circle cx="60" cy="68" r="5" class="accent"></circle>
                      </svg>
                      Touch
                    </div>
                  </div>
                </div>
                <div class="card">
                  <h3>Process</h3>
                  <p>The system <b>thinks</b> and decides what to do next.</p>
                </div>
                <div class="card">
                  <h3>Output</h3>
                  <p>What comes <b>out</b> of the system.<br><br><b>Examples:</b> light, sound, movement, screen, heat</p>
                  <div class="mini-examples" aria-label="Output examples">
                    <div class="mini-card">
                      <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                        <circle cx="60" cy="38" r="14" class="warn"></circle>
                        <rect x="50" y="52" width="20" height="12" rx="4" class="soft2"></rect>
                        <path d="M60 20v-6M42 26l-6-6M78 26l6-6" class="stroke"></path>
                      </svg>
                      Light
                    </div>
                    <div class="mini-card">
                      <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                        <rect x="22" y="36" width="28" height="18" rx="4" class="soft2"></rect>
                        <path d="M50 45h10M60 38c6 2 6 12 0 14M68 34c10 4 10 18 0 22" class="stroke"></path>
                      </svg>
                      Sound
                    </div>
                    <div class="mini-card">
                      <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                        <path d="M24 54h50" class="stroke"></path>
                        <path d="M64 46l10 8-10 8" class="stroke"></path>
                        <circle cx="32" cy="66" r="6" class="soft"></circle>
                        <circle cx="52" cy="66" r="6" class="soft"></circle>
                      </svg>
                      Movement
                    </div>
                    <div class="mini-card">
                      <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                        <rect x="20" y="24" width="80" height="44" rx="8" class="paper"></rect>
                        <rect x="30" y="32" width="60" height="28" rx="6" class="soft2"></rect>
                        <rect x="46" y="70" width="28" height="6" rx="3" class="soft2"></rect>
                      </svg>
                      Screen
                    </div>
                    <div class="mini-card">
                      <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                        <path d="M60 22c10 10 10 18 0 28-10-10-10-18 0-28z" class="warn"></path>
                        <path d="M50 62h20" class="stroke"></path>
                      </svg>
                      Heat
                    </div>
                  </div>
                </div>
                <div class="card">
                  <h3>Example</h3>
                  <p><b>Button</b> (input) ‚Üí system decides (process) ‚Üí <b>washing starts</b> (output)</p>
                </div>
              </div>

              <div class="accordion">
                <details open>
                  <summary>Try it</summary>
                  <div class="detailBody">
                    Think of an air conditioner:<br>
                    <b>Input:</b> remote buttons<br>
                    <b>Process:</b> it decides the temperature and fan speed<br>
                    <b>Output:</b> cold air
                  </div>
                </details>
              </div>
            </div>

            <!-- MICROCONTROLLERS -->
            <div class="page hide" id="micro">
              <div class="cards">
                <div class="card">
                  <svg class="topic-illu" viewBox="0 0 220 140" aria-hidden="true">
                    <rect x="54" y="34" width="112" height="72" rx="12" class="soft"></rect>
                    <rect x="78" y="56" width="64" height="28" rx="8" class="paper"></rect>
                    <path d="M46 46h8M46 62h8M46 78h8M46 94h8" class="stroke"></path>
                    <path d="M166 46h8M166 62h8M166 78h8M166 94h8" class="stroke"></path>
                  </svg>
                  <h3>What is a microcontroller?</h3>
                  <p>A <b>microcontroller</b> is a small computer on <b>one chip</b>. It is the <b>brain</b> that controls embedded systems.</p>
                </div>
                <div class="card">
                  <h3>It has</h3>
                  <p>‚Ä¢ Processor<br>‚Ä¢ Memory<br>‚Ä¢ Input<br>‚Ä¢ Output</p>
                </div>
              </div>

              <div class="accordion">
                <details open>
                  <summary>Where are microcontrollers used?</summary>
                  <div class="detailBody">
                    Electronic devices ‚Ä¢ Household appliances ‚Ä¢ Medical devices ‚Ä¢ Automobiles ‚Ä¢ Safety and alarm systems ‚Ä¢ School coding boards (Micro:bit, Arduino, Ibtikar Maker)
                    <div class="mini-examples" aria-label="Microcontroller use examples">
                      <div class="mini-card">
                        <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                          <rect x="20" y="18" width="80" height="54" rx="10" class="paper"></rect>
                          <rect x="32" y="28" width="56" height="30" rx="6" class="soft2"></rect>
                          <circle cx="60" cy="66" r="6" class="accent"></circle>
                        </svg>
                        Devices
                      </div>
                      <div class="mini-card">
                        <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                          <rect x="18" y="14" width="84" height="62" rx="12" class="paper"></rect>
                          <circle cx="46" cy="44" r="14" class="soft2"></circle>
                          <rect x="66" y="30" width="26" height="8" rx="4" class="soft"></rect>
                          <rect x="66" y="44" width="26" height="8" rx="4" class="soft"></rect>
                        </svg>
                        Appliances
                      </div>
                      <div class="mini-card">
                        <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                          <rect x="30" y="18" width="60" height="54" rx="10" class="paper"></rect>
                          <path d="M60 30v22M48 40h24" class="stroke"></path>
                          <rect x="50" y="72" width="20" height="6" rx="3" class="soft2"></rect>
                        </svg>
                        Medical
                      </div>
                      <div class="mini-card">
                        <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                          <rect x="20" y="48" width="80" height="22" rx="8" class="soft2"></rect>
                          <circle cx="36" cy="74" r="6" class="soft"></circle>
                          <circle cx="84" cy="74" r="6" class="soft"></circle>
                          <rect x="34" y="38" width="30" height="12" rx="6" class="paper"></rect>
                        </svg>
                        Automobiles
                      </div>
                      <div class="mini-card">
                        <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                          <rect x="24" y="18" width="72" height="50" rx="10" class="paper"></rect>
                          <path d="M40 60l10 10 20-26" class="stroke"></path>
                          <circle cx="84" cy="66" r="8" class="warn"></circle>
                        </svg>
                        Safety
                      </div>
                      <div class="mini-card">
                        <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                          <rect x="26" y="22" width="68" height="46" rx="10" class="paper"></rect>
                          <rect x="34" y="30" width="52" height="10" rx="5" class="soft2"></rect>
                          <rect x="34" y="46" width="52" height="10" rx="5" class="soft"></rect>
                          <circle cx="60" cy="72" r="6" class="accent"></circle>
                        </svg>
                        Coding boards
                      </div>
                    </div>
                  </div>
                </details>
                <details>
                  <summary>Embedded system vs microcontroller</summary>
                  <div class="detailBody">
                    <b>Embedded system:</b> the whole system inside a machine.<br>
                    <b>Microcontroller:</b> the brain chip inside the system.<br>
                    <b>Example:</b> Washing machine = embedded system, chip inside it = microcontroller.
                  </div>
                </details>
              </div>
            </div>

            <!-- PROGRAMMING -->
            <div class="page hide" id="programming">
              <div class="cards">
                <div class="card">
                  <svg class="topic-illu" viewBox="0 0 220 140" aria-hidden="true">
                    <rect x="18" y="26" width="74" height="40" rx="10" class="soft"></rect>
                    <rect x="98" y="26" width="74" height="40" rx="10" class="soft2"></rect>
                    <rect x="18" y="76" width="120" height="46" rx="10" class="paper"></rect>
                    <path d="M32 92h76M32 106h60" class="stroke"></path>
                    <path d="M156 88l14 14-14 14" class="stroke"></path>
                  </svg>
                  <h3>Programming microcontrollers</h3>
                  <p>Microcontrollers can be <b>programmed</b> to control lights, sound, screens, sensors, and buttons.</p>
                </div>
                <div class="card">
                  <h3>Two ways to code</h3>
                  <p>‚Ä¢ <b>Block-based</b> coding (drag & drop)<br>‚Ä¢ <b>Text-based</b> coding (typing code)</p>
                </div>
              </div>

              <div class="accordion">
                <details open>
                  <summary>Remember</summary>
                  <div class="detailBody">
                    Block menus store commands for <b>input</b>, <b>processing</b>, and <b>output</b>.
                  </div>
                </details>
              </div>
            </div>

            <!-- VARIABLES -->
            <div class="page hide" id="variables">
              <div class="cards">
                <div class="card">
                  <svg class="topic-illu" viewBox="0 0 220 140" aria-hidden="true">
                    <rect x="22" y="30" width="176" height="80" rx="14" class="paper"></rect>
                    <rect x="36" y="50" width="88" height="16" rx="8" class="soft"></rect>
                    <rect x="36" y="74" width="60" height="10" rx="5" class="soft2"></rect>
                    <circle cx="168" cy="70" r="12" class="accent"></circle>
                  </svg>
                  <h3>What is a variable?</h3>
                  <p>A <b>variable</b> is like a box with a <b>name</b> that stores data. The data can <b>change</b>.</p>
                </div>
                <div class="card">
                  <h3>Examples</h3>
                  <p>score ‚Ä¢ time ‚Ä¢ player name ‚Ä¢ level</p>
                  <div class="mini-examples" aria-label="Variable examples">
                    <div class="mini-card">
                      <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                        <rect x="32" y="34" width="56" height="38" rx="8" class="paper"></rect>
                        <path d="M46 40h28M46 50h20M46 60h16" class="stroke"></path>
                        <circle cx="76" cy="30" r="8" class="warn"></circle>
                      </svg>
                      Score
                    </div>
                    <div class="mini-card">
                      <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                        <circle cx="60" cy="48" r="22" class="paper"></circle>
                        <path d="M60 48v-12M60 48l10 6" class="stroke"></path>
                        <circle cx="60" cy="48" r="3" class="accent"></circle>
                      </svg>
                      Time
                    </div>
                    <div class="mini-card">
                      <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                        <rect x="26" y="30" width="68" height="36" rx="8" class="paper"></rect>
                        <circle cx="42" cy="48" r="8" class="soft2"></circle>
                        <rect x="54" y="42" width="30" height="12" rx="6" class="soft"></rect>
                      </svg>
                      Name
                    </div>
                    <div class="mini-card">
                      <svg class="mini-illu" viewBox="0 0 120 90" aria-hidden="true">
                        <rect x="32" y="56" width="56" height="8" rx="4" class="soft2"></rect>
                        <rect x="38" y="44" width="44" height="8" rx="4" class="soft"></rect>
                        <rect x="46" y="32" width="28" height="8" rx="4" class="soft"></rect>
                        <path d="M86 30l10 10-10 10" class="stroke"></path>
                      </svg>
                      Level
                    </div>
                  </div>
                </div>
                <div class="card">
                  <h3>Data types</h3>
                  <p>Number ‚Ä¢ Text ‚Ä¢ Character ‚Ä¢ Boolean (true/false)</p>
                </div>
                <div class="card">
                  <h3>Quick tip</h3>
                  <p>Always give the variable a clear name (example: <span class="kbd">time</span> or <span class="kbd">score</span>).</p>
                </div>
              </div>
            </div>

            <!-- HARDWARE -->
            <div class="page hide" id="hardware">
              <div class="cards">
                <div class="card">
                  <svg class="topic-illu" viewBox="0 0 220 140" aria-hidden="true">
                    <rect x="24" y="30" width="172" height="80" rx="16" class="soft2"></rect>
                    <circle cx="70" cy="70" r="16" class="accent"></circle>
                    <circle cx="110" cy="70" r="16" class="blue"></circle>
                    <circle cx="150" cy="70" r="16" class="warn"></circle>
                    <path d="M40 106h140" class="stroke"></path>
                    <path d="M52 100v12M84 100v12M116 100v12M148 100v12" class="stroke"></path>
                  </svg>
                  <h3>NeoPixels</h3>
                  <p>NeoPixels are small <b>RGB lights</b> on the microcontroller.<br><br>‚Ä¢ They can change colours<br>‚Ä¢ They can turn on and off<br>‚Ä¢ They are an example of <b>output</b></p>
                </div>
                <div class="card">
                  <h3>Pin Pads</h3>
                  <p>Pin pads are <b>connection points</b> on the microcontroller.<br><br>‚Ä¢ Used for <b>input and output</b><br>‚Ä¢ Can work like <b>buttons when touched</b></p>
                </div>
              </div>

              <div class="accordion">
                <details>
                  <summary>Mini challenge</summary>
                  <div class="detailBody">
                    If you touch a pin pad (input), the microcontroller decides (process), then turns on a NeoPixel (output).
                  </div>
                </details>
              </div>
            </div>

            <!-- PRACTICE -->
            <div class="page hide" id="practice">
              <div class="quiz" id="quiz">
                <svg class="topic-illu" viewBox="0 0 220 140" aria-hidden="true">
                  <rect x="20" y="24" width="160" height="92" rx="12" class="paper"></rect>
                  <path d="M36 50h84M36 70h84M36 90h84" class="stroke"></path>
                  <circle cx="174" cy="78" r="16" class="accent"></circle>
                  <path d="M168 78l6 6 10-12" class="stroke"></path>
                </svg>
                <div class="quiz-top">
                  <h3>Mini Quiz (10 questions)</h3>
                  <button class="btn" id="resetBtn">‚ôªÔ∏è Restart</button>
                </div>
                <p class="tiny">Pick one answer. You will see if it is right or wrong, then move to the next card. Swipe to skip waiting.</p>

                <div class="progress" aria-hidden="true"><span id="quizProgress"></span></div>

                <div class="quiz-card" id="quizCard">
                  <div class="quiz-meta">
                    <span id="quizCount">Question 1 / 10</span>
                    <span id="quizScore">Score: 0</span>
                  </div>
                  <h4 id="quizQuestion">Loading‚Ä¶</h4>
                  <div class="opts" id="quizOptions"></div>
                  <div class="result" id="result"></div>
                </div>

                <div class="revise" id="reviseBox"></div>
              </div>

              <div class="footer">
                <div>Tip: If you score under 8/10, review ‚ÄúEmbedded Systems‚Äù and ‚ÄúInput ‚Üí Process ‚Üí Output‚Äù.</div>
                <div>Made for Grade 4 revision</div>
              </div>
            </div>

          </div>
        </section>
      </div>
    </div>
  </main>

  <script>
    // --- Navigation ---
    const navList = document.getElementById('navList');
    const pages = Array.from(document.querySelectorAll('.page'));
    const panelTitle = document.getElementById('panelTitle');
    const panelDesc = document.getElementById('panelDesc');
    const progressPill = document.getElementById('progressPill');
    const textToggle = document.getElementById('textToggle');

    function applyTextSize(enabled){
      document.body.classList.toggle('large-text', enabled);
      if(textToggle) textToggle.setAttribute('aria-pressed', enabled ? 'true' : 'false');
      if(textToggle) textToggle.textContent = enabled ? 'Aa Normal Text' : 'Aa Large Text';
      try{localStorage.setItem('largeText', enabled ? '1' : '0');}catch(e){}
    }
    try{
      const saved = localStorage.getItem('largeText') === '1';
      applyTextSize(saved);
    }catch(e){}

    const meta = {
      overview: { title: 'Overview', desc: 'Start here. Quick key words + how to study.' },
      embedded: { title: 'Embedded Systems', desc: 'Definition, important points, examples, and why it matters.' },
      ipo: { title: 'Input ‚Üí Process ‚Üí Output', desc: 'How embedded systems work in real life.' },
      micro: { title: 'Microcontrollers', desc: 'The ‚Äúbrain‚Äù chip inside many embedded systems.' },
      programming: { title: 'Programming', desc: 'Block-based and text-based coding basics.' },
      variables: { title: 'Variables', desc: 'A named box that stores data that can change.' },
      hardware: { title: 'NeoPixels & Pin Pads', desc: 'NeoPixels = output lights, Pin pads = connection points.' },
      practice: { title: 'Practice Quiz', desc: 'Answer 10 questions and check your score.' }
    };

    let visited = new Set(['overview']);
    function updateProgress(){
      // count topics excluding practice? include all for simplicity
      const total = 8;
      progressPill.textContent = `${visited.size} / ${total}`;
    }
    updateProgress();

    function show(target){
      pages.forEach(p => p.classList.toggle('hide', p.id !== target));
      const info = meta[target] || {title:'', desc:''};
      panelTitle.textContent = info.title;
      panelDesc.textContent = info.desc;
      visited.add(target);
      updateProgress();

      // active nav
      navList.querySelectorAll('button').forEach(b => b.classList.toggle('active', b.dataset.target === target));
    }

    if(textToggle) textToggle.addEventListener('click', () => {
      const enabled = !document.body.classList.contains('large-text');
      applyTextSize(enabled);
    });

    navList.addEventListener('click', (e) => {
      const btn = e.target.closest('button[data-target]');
      if(!btn) return;
      show(btn.dataset.target);
      window.scrollTo({top:0, behavior:'smooth'});
    });

    // --- Search (simple) ---
    const search = document.getElementById('search');
    search.addEventListener('input', () => {
      const q = search.value.trim().toLowerCase();
      if(!q){
        // show current active
        const activeBtn = navList.querySelector('button.active');
        const active = activeBtn ? activeBtn.dataset.target : 'overview';
        show(active);
        return;
      }
      // find best page by keyword presence in text
      const scores = pages.map(p => {
        const t = p.innerText.toLowerCase();
        const s = (t.match(new RegExp(q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'), 'g')) || []).length;
        return {id:p.id, score:s};
      }).sort((a,b)=>b.score-a.score);

      const best = scores[0];
      if(best && best.score>0) show(best.id);
      else show('overview');
    });

    // --- Print ---
    document.getElementById('printBtn').addEventListener('click', () => window.print());

    // --- Flashcards (Embedded Systems page) ---
    const flashcards = [
      {q:'What is an embedded system?', a:'A small computer inside a bigger machine or device that does specific jobs.'},
      {q:'Give two examples of embedded systems.', a:'Washing machine, air conditioner, microwave, car systems, alarm systems, TV remote, elevator.'},
      {q:'What does ‚Äúpre-programmed‚Äù mean?', a:'It follows instructions that are already written by the maker.'},
      {q:'What is input?', a:'Something that goes into the system (button, sensor, touch, remote).'},
      {q:'What is output?', a:'What comes out of the system (light, sound, movement, screen, heat).'},
      {q:'What is a microcontroller?', a:'The ‚Äúbrain‚Äù chip that controls the embedded system.'}
    ];

    let flashIndex = 0;
    const flashEl = document.getElementById('flash1');
    const flashQ = document.getElementById('flashQ');
    const flashA = document.getElementById('flashA');
    const flashCount = document.getElementById('flashCount');
    const flashCountBack = document.getElementById('flashCountBack');
    let touchStartX = 0;
    let touchStartY = 0;

    function renderFlash(){
      const c = flashcards[flashIndex];
      flashQ.textContent = c.q;
      flashA.textContent = c.a;
      flashCount.textContent = `${flashIndex+1} / ${flashcards.length}`;
      if(flashCountBack) flashCountBack.textContent = `${flashIndex+1} / ${flashcards.length}`;
      if(flashEl) flashEl.classList.remove('flipped');
    }
    if(flashEl) renderFlash();

    function flipFlash(){
      if(!flashEl) return;
      flashEl.classList.toggle('flipped');
    }

    if(flashEl) flashEl.addEventListener('click', flipFlash);
    if(flashEl) flashEl.addEventListener('keydown', (e) => {
      if(e.key === 'Enter' || e.key === ' '){
        e.preventDefault();
        flipFlash();
      }
    });
    if(flashEl) flashEl.addEventListener('touchstart', (e) => {
      touchStartX = e.touches[0].clientX;
      touchStartY = e.touches[0].clientY;
    }, {passive:true});
    if(flashEl) flashEl.addEventListener('touchend', (e) => {
      const dx = e.changedTouches[0].clientX - touchStartX;
      const dy = e.changedTouches[0].clientY - touchStartY;
      if(Math.abs(dx) > 40 && Math.abs(dx) > Math.abs(dy)){
        if(dx < 0){
          flashIndex = (flashIndex + 1) % flashcards.length;
          renderFlash();
        }else{
          flashIndex = (flashIndex - 1 + flashcards.length) % flashcards.length;
          renderFlash();
        }
      }
    }, {passive:true});
    const prevFlash = document.getElementById('prevFlash');
    if(prevFlash) prevFlash.addEventListener('click', () => {
      flashIndex = (flashIndex - 1 + flashcards.length) % flashcards.length;
      renderFlash();
    });
    const nextFlash = document.getElementById('nextFlash');
    if(nextFlash) nextFlash.addEventListener('click', () => {
      flashIndex = (flashIndex + 1) % flashcards.length;
      renderFlash();
    });
    const shuffleFlash = document.getElementById('shuffleFlash');
    if(shuffleFlash) shuffleFlash.addEventListener('click', () => {
      // Fisher-Yates shuffle
      for(let i=flashcards.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [flashcards[i], flashcards[j]] = [flashcards[j], flashcards[i]];
      }
      flashIndex = 0;
      renderFlash();
    });

    // --- Quiz (card + progress) ---
    const resetBtn = document.getElementById('resetBtn');
    const quizQuestion = document.getElementById('quizQuestion');
    const quizOptions = document.getElementById('quizOptions');
    const quizCount = document.getElementById('quizCount');
    const quizScore = document.getElementById('quizScore');
    const quizProgress = document.getElementById('quizProgress');
    const result = document.getElementById('result');
    const reviseBox = document.getElementById('reviseBox');
    const quizCard = document.getElementById('quizCard');
    let quizTouchStartX = 0;
    let quizTouchStartY = 0;

    const quizBank = [
      {q:'An embedded system is‚Ä¶', opts:['a big computer in a classroom','a small computer inside a machine','a phone game'], a:1, topic:'Embedded Systems'},
      {q:'Which one is an INPUT?', opts:['light','screen','button'], a:2, topic:'Input ‚Üí Process ‚Üí Output'},
      {q:'Light and sound are‚Ä¶', opts:['outputs','inputs','variables'], a:0, topic:'Input ‚Üí Process ‚Üí Output'},
      {q:'The ‚Äúbrain‚Äù inside the system is the‚Ä¶', opts:['battery','microcontroller','pencil'], a:1, topic:'Microcontrollers'},
      {q:'NeoPixels are an example of‚Ä¶', opts:['input','process','output'], a:2, topic:'NeoPixels & Pin Pads'},
      {q:'A variable is‚Ä¶', opts:['a robot','a named box that stores data','a washing machine'], a:1, topic:'Variables'},
      {q:'Input ‚Üí Process ‚Üí Output means‚Ä¶', opts:['something goes in, the system decides, then something happens','the screen turns off','a car is fast'], a:0, topic:'Input ‚Üí Process ‚Üí Output'},
      {q:'Pin pads are used for‚Ä¶', opts:['only output','only input','input and output'], a:2, topic:'NeoPixels & Pin Pads'},
      {q:'A microcontroller is‚Ä¶', opts:['small','very big','a book'], a:0, topic:'Microcontrollers'},
      {q:'A washing machine is an‚Ä¶', opts:['microcontroller','embedded system','input'], a:1, topic:'Embedded Systems'}
    ];

    let quizOrder = [];
    let quizIndex = 0;
    let quizScoreCount = 0;
    let missed = new Map();
    let lock = false;

    function shuffle(arr){
      for(let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    function startQuiz(){
      quizOrder = [...quizBank];
      shuffle(quizOrder);
      quizIndex = 0;
      quizScoreCount = 0;
      missed = new Map();
      lock = false;
      reviseBox.textContent = '';
      reviseBox.style.display = 'none';
      result.style.display = 'none';
      result.textContent = '';
      renderQuiz();
    }

    function updateQuizProgress(){
      const total = quizOrder.length;
      const done = Math.min(quizIndex, total);
      quizProgress.style.width = `${Math.round((done / total) * 100)}%`;
      quizCount.textContent = `Question ${Math.min(quizIndex + 1, total)} / ${total}`;
      quizScore.textContent = `Score: ${quizScoreCount}`;
    }

    function renderQuiz(){
      updateQuizProgress();
      const q = quizOrder[quizIndex];
      if(!q){
        const total = quizOrder.length;
        const msg = `Final score: ${quizScoreCount} / ${total}.`;
        result.textContent = msg + (quizScoreCount >= 8 ? ' Great job! üåü' : ' Review the notes and try again.');
        result.className = 'result ' + (quizScoreCount >= 8 ? 'good' : 'bad');
        result.style.display = 'block';

        const missedTopics = Array.from(missed.keys());
        if(missedTopics.length){
          reviseBox.textContent = `Revise: ${missedTopics.join(', ')}.`;
          reviseBox.style.display = 'block';
        }else{
          reviseBox.textContent = 'No revisions needed. You nailed it!';
          reviseBox.style.display = 'block';
        }
        quizOptions.innerHTML = '';
        quizQuestion.textContent = 'Quiz complete!';
        quizCount.textContent = `Question ${total} / ${total}`;
        quizProgress.style.width = '100%';
        return;
      }

      quizQuestion.textContent = q.q;
      quizOptions.innerHTML = '';
      result.style.display = 'none';
      result.textContent = '';
      q.opts.forEach((opt, idx) => {
        const label = document.createElement('label');
        label.className = 'opt';
        label.innerHTML = `<input type="radio" name="quizOpt" value="${idx}"> ${opt}`;
        label.addEventListener('click', () => handleAnswer(idx));
        quizOptions.appendChild(label);
      });
      lock = false;
    }

    function handleAnswer(choice){
      if(lock) return;
      lock = true;
      const q = quizOrder[quizIndex];
      const correct = choice === q.a;
      if(correct){
        quizScoreCount++;
        result.className = 'result good';
        result.textContent = 'Correct! ‚úÖ';
      }else{
        result.className = 'result bad';
        result.textContent = `Not quite. The right answer is: ${q.opts[q.a]}.`;
        missed.set(q.topic, (missed.get(q.topic) || 0) + 1);
      }
      result.style.display = 'block';
      updateQuizProgress();
      setTimeout(() => {
        quizIndex++;
        renderQuiz();
      }, 900);
    }

    if(resetBtn) resetBtn.addEventListener('click', startQuiz);
    if(quizCard) quizCard.addEventListener('touchstart', (e) => {
      quizTouchStartX = e.touches[0].clientX;
      quizTouchStartY = e.touches[0].clientY;
    }, {passive:true});
    if(quizCard) quizCard.addEventListener('touchend', (e) => {
      const dx = e.changedTouches[0].clientX - quizTouchStartX;
      const dy = e.changedTouches[0].clientY - quizTouchStartY;
      if(Math.abs(dx) > 50 && Math.abs(dx) > Math.abs(dy) && lock){
        quizIndex++;
        renderQuiz();
      }
    }, {passive:true});

    // Start on overview
    show('overview');
    startQuiz();
  </script>
</body>
</html>
